# Blood Performance Benchmark Results

**Generated**: Wed Jan 14 02:39:27 AM UTC 2026
**System**: Linux 6.1.0-39-amd64 x86_64
**Runs per benchmark**: 1

## Methodology

- Each benchmark compiled with maximum optimization
- Blood: `blood build --release`
- C: `gcc -O2` and `gcc -O3 -march=native`
- Timing: wall-clock time via bash `time` builtin
- Output verification: numerical results compared between Blood and C

---

## Benchmark 1: Pass-by-Value Struct (val_test)

**Test**: 10M iterations passing `Point{x: f64, y: f64}` by value

### Output Verification
- Blood: `Sum: 3e+07`
- C: `Sum: 3e+07`
- Match: YES

### Timing Results

| Implementation | Avg (ms) | Min (ms) | Max (ms) | vs C -O2 |
|----------------|----------|----------|----------|----------|
| Blood          | 5 | 5 | 5 | 1.00x |
| C (gcc -O2)    | 5 | 5 | 5 | 1.00x |
| C (gcc -O3)    | 5 | 5 | 5 | - |

---

## Benchmark 2: N-Body Simulation (50M iterations)

**Test**: CLBG n-body benchmark, 5 bodies, 50,000,000 timesteps

### Output Verification
| Metric | Blood | C |
|--------|-------|---|
| Initial energy | -0.169075 | -0.169075164 |
| Final energy | -0.16906 | -0.169059907 |

### Timing Results

| Implementation | Avg (ms) | Min (ms) | Max (ms) | vs C -O2 |
|----------------|----------|----------|----------|----------|
| Blood          | 1747 | 1747 | 1747 | 0.49x |
| C (gcc -O2)    | 3558 | 3558 | 3558 | 1.00x |
| C (gcc -O3)    | 2036 | 2036 | 2036 | - |

---

## Analysis

### Key Observations

1. **val_test**: Tests Copy trait detection for stack allocation of structs.
   - If Blood matches C, Copy trait detection is working correctly.
   - Structs like `Point{f64, f64}` should be stack-allocated, not heap-allocated.

2. **nbody**: Tests overall floating-point and struct performance.
   - Blood uses explicit unrolled function calls (no loop overhead).
   - Performance difference reflects LLVM vs gcc optimization strategies.

### Verification Notes

- Output values must match between Blood and C to confirm correctness.
- Small floating-point differences in later decimal places are acceptable.
- If outputs differ significantly, investigate potential bugs.

### Reproducing These Results

```bash
# Build Blood compiler
cargo build --release

# Run benchmarks
./benchmarks/run_perf_benchmarks.sh

# Quick verification (fewer runs)
./benchmarks/run_perf_benchmarks.sh --quick
```


// Test: stdlib string formatting functions
// EXPECT: 0
// EXPECT: 42
// EXPECT: 1000000
// EXPECT: 0
// EXPECT: 99999
// EXPECT: 0
// EXPECT: 12345
// EXPECT: -42
// EXPECT: -1
// EXPECT: ff
// EXPECT: 0a
// EXPECT: [42]
// EXPECT: [-100]

mod stdlib_fmt;

fn main() -> i32 {
    // Test push_u32
    let mut s = String.new();
    stdlib_fmt::push_u32(&mut s, 0);
    print_string(&s); // 0

    let mut s2 = String.new();
    stdlib_fmt::push_u32(&mut s2, 42);
    print_string(&s2); // 42

    let mut s3 = String.new();
    stdlib_fmt::push_u32(&mut s3, 1000000);
    print_string(&s3); // 1000000

    // Test push_u64
    let mut s4 = String.new();
    stdlib_fmt::push_u64(&mut s4, 0);
    print_string(&s4); // 0

    let mut s5 = String.new();
    stdlib_fmt::push_u64(&mut s5, 99999);
    print_string(&s5); // 99999

    // Test push_usize
    let mut s6 = String.new();
    stdlib_fmt::push_usize(&mut s6, 0);
    print_string(&s6); // 0

    let mut s7 = String.new();
    stdlib_fmt::push_usize(&mut s7, 12345);
    print_string(&s7); // 12345

    // Test push_i64 (negative)
    let mut s8 = String.new();
    stdlib_fmt::push_i64(&mut s8, -42);
    print_string(&s8); // -42

    // Test push_i32 (negative)
    let mut s9 = String.new();
    stdlib_fmt::push_i32(&mut s9, -1);
    print_string(&s9); // -1

    // Test push_hex_u64
    let mut s10 = String.new();
    stdlib_fmt::push_hex_u64(&mut s10, 255);
    print_string(&s10); // ff

    // Test push_hex_u8 (zero-padded)
    let mut s11 = String.new();
    stdlib_fmt::push_hex_u8(&mut s11, 10);
    print_string(&s11); // 0a

    // Test format variants (return String)
    let formatted = stdlib_fmt::format_u32(42);
    let mut out = String.new();
    out.push('[');
    out.push_str(formatted.as_str());
    out.push(']');
    print_string(&out); // [42]

    let formatted2 = stdlib_fmt::format_i64(-100);
    let mut out2 = String.new();
    out2.push('[');
    out2.push_str(formatted2.as_str());
    out2.push(']');
    print_string(&out2); // [-100]

    0
}

fn print_string(s: &String) {
    println_str(s.as_str());
}

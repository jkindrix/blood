// BUG-008 reproduction: if-expression with function call condition
// and String return branches.
//
// The actual bug pattern from codegen_types.blood:
//   fn ref_to_llvm(ty: &Type) -> String {
//       if is_unsized_type(ty) {
//           make_string("{ ptr, i64 }")
//       } else {
//           make_string("ptr")
//       }
//   }
//
// Blood-rust eliminates the conditional branch, always returning
// the else-branch result. This only manifests in larger codebases
// (likely due to inlining/optimization threshold interactions).

fn is_special(x: i32) -> bool {
    x > 10
}

fn make_string(s: &str) -> String {
    let mut result = String::new();
    result.push_str(s);
    result
}

fn classify(x: i32) -> String {
    if is_special(x) {
        make_string("special")
    } else {
        make_string("normal")
    }
}

fn main() -> i32 {
    let result = classify(42);
    if str_eq(result.as_str(), "special") {
        0
    } else {
        1
    }
}

// EXPECT: exit code 0 (42 > 10 so classify returns "special")
